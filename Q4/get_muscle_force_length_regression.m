function [force_length_regression] = get_muscle_force_length_regression()
%%% TASK 2

%-similar to velocity regression: need to extract data (look at figure and
%the gaussian type bump, extrace data pts with webplot and select points,
%need to calibrate webplotter, so check after that extracted data matches
%og graph); length not normalized, so need to normalizze it by shifintg max
%force to 1 then set length that correspoinds to max force is also 1; then
%use fit fct in matlab (different from velocity part) and provide with x
%and y and gaussian fct; 

% Input Parameters
% data(:,1): samples of an independent variable
% data(:,2): corresponding samples of a dependent variable

% Output
% force_length_regression: the genered Gaussian model

%     WRITE CODE HERE
%      1) Use WebPlotDigitizer to extract force-length points
%     from Winters et al. (2011) Figure 3C, which is on Learn. Click
%     "View Data", select all, cut, and paste below. 
%     2) Normalize the data so optimal length = 1 and peak = 1. 
%     3) Return a Regression object that  uses Gaussian basis functions.

% Define data points
data = [37.39300371311315, 9.749579831932778
38.402872777017784, 14.235152646917342
39.25737736955247, 24.15178960473078
39.412741840922415, 3.3097416744475368
40.39671682626539, 36.36339869281048
40.38808546674484, 21.67361759518623
40.38808546674484, 17.593733789812234
41.35479773304671, 31.553314659197028
41.389323171128915, 14.642581180620411
41.43247996873168, 26.518892001244936
41.96474713916574, 31.73953038005324
42.49413718975963, 41.93050775865902
42.286984561266365, 31.460939931528188
42.787603413458406, 46.3557573152718
42.89117972770504, 48.55191409897293
43.19327731092437, 50.31528166822285
43.40042993941763, 44.465981948334914
43.39807593227566, 34.59178338001868
43.42632401797928, 53.72104990144207
43.69677328295659, 56.656670569462364
43.957152628493255, 59.05788982259571
44.3844049247606, 45.44292717086836
44.41029900332226, 60.42884808244287
45.23492581290118, 53.689243218654994
45.55333761411541, 45.58003328315455
45.34248583154192, 43.04077186430128
45.70500293140512, 67.31613049260109
45.60142661715849, 53.0700280112045
45.86036740277506, 70.72019919078744
46.435488516091866, 72.22927580388884
46.404143052569864, 62.690196078431384
46.67603087746726, 75.51213818860879
47.120545892775716, 80.58070388649288
47.38811803791283, 71.4113600995954
47.38811803791283, 62.59122315592906
47.65223763924175, 81.64186118892003
47.690215621132175, 66.84925822180725
48.190834473324216, 83.34034650897397
48.89860595400951, 85.09601618425148
48.971972509934204, 81.21957671957674
49.45964432284541, 76.08453159041395
49.62980541053631, 85.88732826463921
49.70563806918116, 81.9998132586368
50.24164549540747, 84.34547152194213
50.26236075825679, 87.5503090124939
50.003419972640216, 81.27731092436976
50.55582698195557, 74.5104955562472
50.65077193668165, 90.38611889200126
50.69146263156425, 77.9122315592904
50.754348250928274, 85.01613089680319
50.73881180379128, 87.0210395269219
51.06308534147111, 79.1115803586392
51.26359846264087, 77.81325863678806
51.50926023361043, 89.56997294644356
51.79011139339457, 91.1201680672269
51.81600547195622, 88.79925303454716
52.6187219073676, 89.19052598817305
53.24881115236792, 88.76626206037972
53.469527345822044, 94.02911355018199
53.525014657025594, 83.34474530552964
53.70257405287697, 92.17847138855544
53.48617353918311, 79.44631185807657
53.74411839870116, 96.64352783848582
54.18962934010814, 94.05272528764593
54.09468438538205, 91.37254901960786
54.63846003517686, 99.40255213196392
54.508989642368576, 93.94584500466854
55.75190541332812, 96.00628130039897
56.19210474887629, 96.06276584707959
56.4251514559312, 99.64488583312114
56.96211287452557, 99.08514423313187
57.543775649794796, 99.13937841803389
57.79753761969904, 91.02449424214132
57.95290209106898, 99.25079365079367
58.433381104379734, 90.85202476052152
58.5484658979871, 96.1310257436308
58.9109829978503, 98.76042780748665
59.35118233339847, 90.99150326797387
59.4858315419191, 97.77609710550888
59.68040704653954, 95.48487394957985
60.050322454563215, 95.43439775910366
60.5423099472347, 99.4751322751323
60.581151065077194, 93.62418300653596
61.29323822552276, 84.49842967490028
61.33812129502964, 94.21197219628593
61.34502638264608, 91.6496732026144
61.396814539769395, 87.0210395269219
61.38990945215295, 78.94704844900926
61.411611156090345, 76.46062869592282
61.396814539769395, 88.08664799253036
62.173636896619115, 89.4740684152449
62.3031072894274, 96.35583566760039
62.56204807504396, 79.64623716153129
63.15761188196208, 85.93053787171436
63.41655266757866, 79.78957999866614
63.670785438911295, 89.49386299974537
63.71757133085792, 85.7535969943533
63.934434238811804, 75.9225758990465
63.94594271817253, 80.16478196216761
64.45231581004495, 86.76114396375836
64.50410396716826, 81.73588546529724
65.09966777408637, 76.05648926237163
65.08413132694939, 57.4842203548086
65.35860855970294, 64.1450980392157
65.59165526675787, 72.66666666666669
65.6984683408247, 66.71220821662
65.64344342388118, 57.76417233560092
66.13543091655266, 72.09262371615314
66.00596052374438, 65.83753501400561
66.26490130936095, 55.51735845853494
66.39437170216924, 75.39666977902272
66.6015243306625, 55.09897292250234
66.86046511627906, 66.14765017117959
66.86046511627906, 68.55929038281981
67.20818559982132, 62.28747054377307
67.44190488034538, 58.72626626408139
67.48192300175884, 51.526050420168076
67.76675786593707, 62.169195759111744
67.76675786593707, 68.98267455130203
68.41928864569083, 58.72072206660444
68.36232167285519, 56.80625583566761
68.90609732264998, 59.7577697745765
69.37219073675982, 41.90708202472909
70.53742427203439, 48.38530967942734
70.51153019347274, 29.71241830065361
71.39192886456908, 34.580086580086586
72.42251319132303, 24.645004668534085
72.97146765683017, 25.535760971055097
73.41166699237834, 34.59208329796567
73.41166699237834, 17.989825425119548
73.41166699237834, 12.356166709107896
74.39564197772131, 12.65425182418646
75.1983584131327, 17.568440709617178
75.40551104162594, 12.308029878618129
76.38948602696892, 8.286430127606607];
% Normalization

A = [1 2; 3 4];

class(A)
plot(data(:,1), data(:,2));
[maxForce, maxPt] = max(data(:,2));

disp(data(maxPt, 2));
disp(data(maxPt, 1));
maxLength = data(maxPt, 1); 
for i = 1:size(data)
    
    data(i,1) = data(i,1)/maxLength;
    data(i,2) = data(i, 2)/maxForce;
end 
length = data(:,1);
force = data(:,2);

% Regression with "fit" function with "gauss2" option as model type
force_length_regression = fit(data(:,1),data(:,2),'gauss2');

end
